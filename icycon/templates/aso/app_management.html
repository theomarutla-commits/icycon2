{% extends "base.html" %}

{% block title %}App Management - ASO - Icycon{% endblock %}

{% block breadcrumb %} / <a href="/aso-ui/">ASO</a> / App Management {% endblock %}

{% block content %}
<div class="row g-4">
    <!-- App Management -->
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">App Management</h5>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAppModal">
                    Add New App
                </button>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table" id="appsTable">
                        <thead>
                            <tr>
                                <th>App Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Last Updated</th>
                                <th>Performance</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="6" class="text-center">Loading apps...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Store Listing Preview -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Store Listing Preview</h5>
            </div>
            <div class="card-body">
                <div class="store-preview" id="storePreview">
                    <div class="preview-placeholder text-center p-5">
                        Select an app to preview its store listing
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Optimization Suggestions -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Optimization Suggestions</h5>
            </div>
            <div class="card-body">
                <div class="suggestions-list" id="suggestionsList">
                    <div class="text-center p-5">
                        Select an app to see optimization suggestions
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add App Modal -->
<div class="modal fade" id="addAppModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New App</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="addAppForm">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">App Name</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Platform</label>
                            <select class="form-select" required>
                                <option value="google">Google Play Store</option>
                                <option value="apple">Apple App Store</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label class="form-label">Store URL</label>
                            <input type="url" class="form-control" required>
                        </div>
                        <div class="col-12">
                            <label class="form-label">App Description</label>
                            <textarea class="form-control" rows="4"></textarea>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Category</label>
                            <select class="form-select">
                                <option>Health & Fitness</option>
                                <option>Business</option>
                                <option>Education</option>
                                <!-- Add more categories -->
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Primary Language</label>
                            <select class="form-select">
                                <option value="en">English</option>
                                <option value="es">Spanish</option>
                                <option value="fr">French</option>
                                <!-- Add more languages -->
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addApp()">Add App</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_css %}
<style>
    .store-preview {
        min-height: 400px;
        background: #f8f9fa;
        border-radius: 8px;
    }
    .app-icon {
        width: 80px;
        height: 80px;
        border-radius: 16px;
    }
    .status-badge {
        padding: 0.25rem 0.5rem;
        border-radius: 999px;
        font-size: 0.875rem;
    }
    .status-active { background: #dcfce7; color: #166534; }
    .status-pending { background: #fef9c3; color: #854d0e; }
    .status-suspended { background: #fee2e2; color: #991b1b; }
    .preview-placeholder {
        color: #6c757d;
    }
    .suggestion-item {
        padding: 1rem;
        border-bottom: 1px solid #e9ecef;
    }
    .suggestion-item:last-child {
        border-bottom: none;
    }
    .suggestion-priority {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        margin-right: 8px;
    }
    .priority-high { background: #ef4444; }
    .priority-medium { background: #f59e0b; }
    .priority-low { background: #10b981; }
</style>
{% endblock %}

{% block extra_js %}
<script>
    // Load apps data
    function loadApps() {
        // Simulate API call
        setTimeout(() => {
            const apps = [
                {
                    name: 'FitTrack Pro',
                    platform: 'google',
                    status: 'active',
                    lastUpdated: '2023-11-01',
                    performance: 85
                },
                {
                    name: 'GymBuddy',
                    platform: 'apple',
                    status: 'pending',
                    lastUpdated: '2023-10-28',
                    performance: 72
                }
            ];

            updateAppsTable(apps);
        }, 1000);
    }

    function updateAppsTable(apps) {
        const tbody = document.getElementById('appsTable').querySelector('tbody');
        tbody.innerHTML = apps.map(app => `
            <tr>
                <td>
                    <div class="d-flex align-items-center">
                        <img src="https://via.placeholder.com/80" class="app-icon me-3">
                        <div>
                            <h6 class="mb-0">${app.name}</h6>
                            <small class="text-muted">ID: ${Math.random().toString(36).substr(2, 9)}</small>
                        </div>
                    </div>
                </td>
                <td>${app.platform === 'google' ? 'Google Play' : 'App Store'}</td>
                <td>
                    <span class="status-badge status-${app.status}">
                        ${app.status.charAt(0).toUpperCase() + app.status.slice(1)}
                    </span>
                </td>
                <td>${app.lastUpdated}</td>
                <td>
                    <div class="progress" style="width: 100px">
                        <div class="progress-bar" style="width: ${app.performance}%"></div>
                    </div>
                </td>
                <td>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-outline-secondary" onclick="previewApp('${app.name}')">
                            Preview
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" onclick="editApp('${app.name}')">
                            Edit
                        </button>
                    </div>
                </td>
            </tr>
        `).join('');
    }

    function previewApp(appName) {
        const preview = document.getElementById('storePreview');
        preview.innerHTML = `
            <div class="p-4">
                <div class="d-flex align-items-start mb-4">
                    <img src="https://via.placeholder.com/80" class="app-icon me-3">
                    <div>
                        <h5 class="mb-1">${appName}</h5>
                        <p class="text-muted mb-2">Developer Name</p>
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <i class="bx bxs-star text-warning"></i>
                                <span>4.5</span>
                            </div>
                            <div>
                                <i class="bx bx-download"></i>
                                <span>10K+</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <h6>Description</h6>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                </div>

                <div class="mb-4">
                    <h6>Screenshots</h6>
                    <div class="d-flex gap-2 overflow-auto py-2">
                        <img src="https://via.placeholder.com/200x400" style="border-radius: 8px">
                        <img src="https://via.placeholder.com/200x400" style="border-radius: 8px">
                        <img src="https://via.placeholder.com/200x400" style="border-radius: 8px">
                    </div>
                </div>
            </div>
        `;

        // Update suggestions
        const suggestions = document.getElementById('suggestionsList');
        suggestions.innerHTML = `
            <div class="suggestion-item d-flex align-items-start">
                <div class="suggestion-priority priority-high">H</div>
                <div>
                    <h6 class="mb-1">Optimize App Title</h6>
                    <p class="mb-2">Include main keyword in the app title for better visibility.</p>
                    <small class="text-muted">Estimated impact: High</small>
                </div>
            </div>
            <div class="suggestion-item d-flex align-items-start">
                <div class="suggestion-priority priority-medium">M</div>
                <div>
                    <h6 class="mb-1">Add More Screenshots</h6>
                    <p class="mb-2">Utilize all available screenshot slots to showcase features.</p>
                    <small class="text-muted">Estimated impact: Medium</small>
                </div>
            </div>
            <div class="suggestion-item d-flex align-items-start">
                <div class="suggestion-priority priority-low">L</div>
                <div>
                    <h6 class="mb-1">Update Change Log</h6>
                    <p class="mb-2">Keep users informed about recent updates and improvements.</p>
                    <small class="text-muted">Estimated impact: Low</small>
                </div>
            </div>
        `;
    }

    function editApp(appName) {
        // Implement edit functionality
        alert(`Editing ${appName}...`);
    }

    function addApp() {
        // Implement add app functionality
        alert('Adding new app...');
        $('#addAppModal').modal('hide');
    }

    // Load data on page load
    loadApps();
</script>
{% endblock %}