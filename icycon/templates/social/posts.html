{% extends "social/base_social.html" %}

{% block social_content %}
<div class="action-bar">
  <div class="search-bar">
    <input type="text" placeholder="Search posts..." class="form-control">
    <button class="btn btn-primary">Search</button>
  </div>
  <div class="filters">
    <select class="form-control">
      <option>All Platforms</option>
      <option>Twitter</option>
      <option>LinkedIn</option>
      <option>Facebook</option>
      <option>Instagram</option>
    </select>
    <select class="form-control">
      <option>All Status</option>
      <option>Published</option>
      <option>Scheduled</option>
      <option>Draft</option>
    </select>
  </div>
  <button class="btn btn-primary" onclick="window.location.href='{% url 'social_posts' %}?action=create'">
    <i class='bx bx-plus'></i> Create Post
  </button>
</div>

<div class="stat-grid">
  <div class="stat-card">
    <h3>{{ stats.total_posts|default:"0" }}</h3>
    <p>Total Posts</p>
  </div>
  <div class="stat-card">
    <h3>{{ stats.scheduled_posts|default:"0" }}</h3>
    <p>Scheduled</p>
  </div>
  <div class="stat-card">
    <h3>{{ stats.engagement_rate|default:"0" }}%</h3>
    <p>Avg. Engagement</p>
  </div>
  <div class="stat-card">
    <h3>{{ stats.reach|default:"0" }}</h3>
    <p>Total Reach</p>
  </div>
</div>

<div class="social-grid">
  {% for post in posts %}
  <div class="social-card">
    <div style="display:flex;gap:1rem;align-items:center;margin-bottom:1rem">
      <img src="{{ post.account.profile_image|default:'https://via.placeholder.com/40' }}" 
           alt="{{ post.account.username }}" 
           style="width:40px;height:40px;border-radius:50%;object-fit:cover">
      <div>
        <div style="font-weight:500">{{ post.account.display_name }}</div>
        <div style="font-size:0.875rem;color:var(--text-light)">{{ post.created_at|date:"M j, Y" }}</div>
      </div>
      <span class="badge" style="margin-left:auto;
                               background:{% if post.status == 'published' %}#22c55e{% elif post.status == 'scheduled' %}#3b82f6{% else %}#64748b{% endif %};
                               color:white;
                               padding:0.25rem 0.5rem;
                               border-radius:9999px;
                               font-size:0.75rem">
        {{ post.status|title }}
      </span>
    </div>
    
    {% if post.media %}
    <div style="margin:-1rem -1.5rem 1rem -1.5rem">
      <img src="{{ post.media|default:'https://via.placeholder.com/600x400' }}" 
           alt="Post media"
           style="width:100%;height:200px;object-fit:cover">
    </div>
    {% endif %}
    
    <div style="margin-bottom:1rem">
      {{ post.content|truncatechars:150 }}
    </div>
    
    <div style="display:flex;gap:1rem;color:var(--text-light);font-size:0.875rem">
      <div>
        <i class='bx bx-heart'></i> {{ post.likes|default:"0" }}
      </div>
      <div>
        <i class='bx bx-comment'></i> {{ post.comments|default:"0" }}
      </div>
      <div>
        <i class='bx bx-share'></i> {{ post.shares|default:"0" }}
      </div>
      {% if post.scheduled_at %}
      <div style="margin-left:auto">
        <i class='bx bx-calendar'></i> {{ post.scheduled_at|date:"M j, Y H:i" }}
      </div>
      {% endif %}
    </div>
    
    <div style="margin-top:1rem;display:flex;gap:0.5rem;justify-content:flex-end">
      <button class="btn btn-sm btn-secondary">View Analytics</button>
      <button class="btn btn-sm btn-primary">Edit</button>
    </div>
  </div>
  {% empty %}
  <div class="social-card" style="grid-column:1/-1;text-align:center">
    <i class='bx bx-message-square-detail' style="font-size:3rem;color:var(--text-light)"></i>
    <h3>No Posts Yet</h3>
    <p>Start creating and scheduling social media posts.</p>
    <button class="btn btn-primary" onclick="window.location.href='{% url 'social_posts' %}?action=create'">
      <i class='bx bx-plus'></i> Create Post
    </button>
  </div>
  {% endfor %}
</div>
{% endblock %}